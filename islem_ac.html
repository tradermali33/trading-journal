<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>İşlem Aç</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  font-family: Arial, sans-serif;
  background:#0b0e1a;
  color:#fff;
  padding:20px;
}
h1{margin-bottom:20px}
.box{
  background:#131722;
  padding:15px;
  border-radius:10px;
  margin-bottom:15px;
}
input,select,button{
  width:100%;
  padding:10px;
  margin-top:8px;
  border-radius:6px;
  border:none;
}
button{
  font-size:16px;
  font-weight:bold;
  cursor:pointer;
}
.green{background:#16a34a;color:#fff}
.red{background:#dc2626;color:#fff}
.info{opacity:.8;font-size:14px}
</style>
</head>

<body>

<h1>⚡ Yeni İşlem Aç</h1>

<div class="box">
  <label>Varlık</label>
  <input id="varlik" placeholder="BTCUSDT / ALKA">
</div>

<div class="box">
  <label>Giriş Fiyatı</label>
  <input id="girisFiyat" type="number" step="0.01">
</div>

<div class="box">
  <label>Adet</label>
  <input id="adet" type="number" step="0.01">
</div>

<div class="box">
  <label>Stop Oranı (%)</label>
  <input id="stopOran" type="number" value="1">
</div>

<div class="box">
  <button class="green" onclick="islemBaslat()">⚡ İŞLEM BAŞLAT ⚡</button>
</div>

<div class="box info" id="kasaInfo"></div>

<script>
/* ===============================
   CORE ENGINE (INLINE)
   =============================== */

const Core = {
  kasa:{ bakiye:100000 },
  aktifIslemler:[]
};

function kasaYukle(){
  const k=localStorage.getItem("kasa");
  if(k) Core.kasa.bakiye=Number(k);
}

function kasaKaydet(){
  localStorage.setItem("kasa",Core.kasa.bakiye);
}

function islemKaydet(){
  localStorage.setItem("aktifIslemler",JSON.stringify(Core.aktifIslemler));
}

function islemBaslat(){
  const varlik=document.getElementById("varlik").value.trim();
  const girisFiyat=Number(document.getElementById("girisFiyat").value);
  const adet=Number(document.getElementById("adet").value);
  const stopOran=Number(document.getElementById("stopOran").value);

  if(!varlik||!girisFiyat||!adet){
    alert("Eksik alan var");
    return;
  }

  const tutar=girisFiyat*adet;
  if(tutar>Core.kasa.bakiye){
    alert("Kasa yetersiz");
    return;
  }

  const islem={
    id:Date.now(),
    varlik,
    girisFiyat,
    adet,
    tutar,
    stopFiyat:girisFiyat*(1-stopOran/100),
    durum:"AKTIF",
    zaman:new Date().toISOString()
  };

  Core.aktifIslemler.push(islem);
  Core.kasa.bakiye-=tutar;

  kasaKaydet();
  islemKaydet();
  guncelle();

  alert("İşlem açıldı");
}

function guncelle(){
  document.getElementById("kasaInfo").innerText=
    "Güncel Kasa: "+Core.kasa.bakiye.toFixed(2)+" TL";
}

(function init(){
  kasaYukle();
  guncelle();
})();
</script>

</body>
</html>