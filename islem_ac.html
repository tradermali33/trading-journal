<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Yeni Ä°ÅŸlem AÃ§</title>

<style>
*{box-sizing:border-box;font-family:"Times New Roman",serif;}
body{margin:0;padding:16px;background:#f2f4f6;}

.card{
  background:#fff;
  border-radius:16px;
  padding:16px;
  margin-bottom:16px;
  box-shadow:0 4px 10px rgba(0,0,0,.06);
}

.card h2{
  margin:0 0 14px;
  font-size:18px;
  font-weight:bold;
  text-align:center;
}

.center{text-align:center;font-weight:bold;}
input{width:100%;padding:12px;border-radius:12px;border:1px solid #ddd;font-size:15px;}
.row{display:flex;gap:12px;}
.row>div{flex:1;}

.badge-group{
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  justify-content:center;
}

.badge{
  padding:10px 18px;
  background:#eef1f4;
  border-radius:20px;
  font-size:14px;
  cursor:pointer;
  user-select:none;
}

.badge.active{background:#2ecc71;color:#fff;}
.badge.stop{background:#ffdede;}
.badge.stop.active{background:#e74c3c;color:#fff;}

.warning{
  margin-top:10px;
  padding:10px;
  border-radius:10px;
  background:#ffe5e5;
  color:#b30000;
  text-align:center;
  font-weight:bold;
  display:none;
}

.btn{
  width:100%;
  padding:16px;
  border:none;
  border-radius:16px;
  font-size:16px;
  font-weight:bold;
  cursor:pointer;
}

.btn-green{background:#2ecc71;color:#fff;}
.btn-red{background:#e74c3c;color:#fff;}
.btn-yellow{background:#f1c40f;}
.btn[disabled]{opacity:.5;cursor:not-allowed;}

.footer-back{text-align:center;margin:20px 0;font-size:18px;}
</style>
</head>

<body>

<!-- TARÄ°H -->
<div class="card center">
  ğŸ’° 12.12.2012 Pazartesi ğŸ’°
</div>

<!-- VARLIK -->
<div class="card">
  <h2>ğŸ’ VarlÄ±k</h2>
  <input placeholder="ALKA / BTCUSDT">
  <div class="center" style="margin-top:8px;">ğŸ”´ CanlÄ± Fiyat: --</div>
</div>

<!-- GÄ°RÄ°Å -->
<div class="card">
  <h2>ğŸ“Œ GiriÅŸ</h2>
  <input id="fiyat" placeholder="GiriÅŸ FiyatÄ±">
  <div class="row" style="margin-top:10px;">
    <div><input id="adet" placeholder="Adet"></div>
    <div><input id="tutar" placeholder="Tutar (TL)"></div>
  </div>
</div>

<!-- STOP -->
<div class="card">
  <h2>ğŸ›‘ Stop</h2>

  <div class="badge-group" id="stopGroup">
    <div class="badge stop" data-stop="0.5">%0.5</div>
    <div class="badge stop" data-stop="1">%1</div>
    <div class="badge stop" data-stop="2">%2</div>
  </div>

  <input id="stopFiyat" style="margin-top:10px;" placeholder="Stop FiyatÄ±" disabled>

  <div id="stopWarning" class="warning">
    âš ï¸ Stop oranÄ± aÅŸÄ±ldÄ± â€” Onay gerekli
    <br><br>
    <button id="confirmStop" class="btn btn-red">ONAYLA</button>
  </div>
</div>

<!-- BUTONLAR -->
<div class="card">
  <button class="btn btn-yellow">ğŸš¨ Otomatik Ä°ÅŸlem SonlandÄ±r</button><br><br>
  <button class="btn btn-red">âš ï¸ Manuel Ä°ÅŸlem SonlandÄ±r</button><br><br>
  <button id="startBtn" class="btn btn-green" disabled>âš¡ Ä°ÅLEM BAÅLAT âš¡</button>
</div>

<!-- SON KASA -->
<div class="card center">
  <h2>ğŸ¦ Ä°ÅŸlem SonrasÄ± Kasa</h2>
  <div style="font-size:22px;">0 TL</div>
</div>

<div class="footer-back">â†©ï¸ Geri</div>

<script>
const fiyat = document.getElementById("fiyat");
const adet = document.getElementById("adet");
const tutar = document.getElementById("tutar");
const stopFiyat = document.getElementById("stopFiyat");
const stopBadges = document.querySelectorAll("#stopGroup .badge");
const warning = document.getElementById("stopWarning");
const confirmBtn = document.getElementById("confirmStop");
const startBtn = document.getElementById("startBtn");

let stopYuzde = null;
let stopOnaylandi = false;

// adet / tutar hesap
adet.oninput = ()=>{ if(fiyat.value) tutar.value=(adet.value*fiyat.value).toFixed(2); };
tutar.oninput = ()=>{ if(fiyat.value) adet.value=(tutar.value/fiyat.value).toFixed(2); };

// STOP YÃœZDESÄ° SEÃ‡Ä°MÄ° (ZORUNLU)
stopBadges.forEach(b=>{
  b.onclick=()=>{
    stopBadges.forEach(x=>x.classList.remove("active"));
    b.classList.add("active");
    stopYuzde = parseFloat(b.dataset.stop);
    stopOnaylandi = false;
    warning.style.display="none";
    stopFiyat.disabled=false;
    hesaplaStop();
    startBtn.disabled=true;
  };
});

function hesaplaStop(){
  if(!fiyat.value || !stopYuzde) return;
  const g = parseFloat(fiyat.value);
  stopFiyat.value = (g - (g*stopYuzde/100)).toFixed(2);
}

fiyat.onblur = hesaplaStop;

// MANUEL STOP KONTROL
stopFiyat.oninput = ()=>{
  if(!fiyat.value || !stopYuzde) return;

  const g = parseFloat(fiyat.value);
  const s = parseFloat(stopFiyat.value);
  const yuzde = ((g - s)/g)*100;

  if(yuzde > stopYuzde){
    warning.style.display="block";
    startBtn.disabled=true;
  }else{
    warning.style.display="none";
    startBtn.disabled=false;
  }
};

confirmBtn.onclick=()=>{
  stopOnaylandi=true;
  warning.style.display="none";
  startBtn.disabled=false;
};
</script>

</body>
</html>