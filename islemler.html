<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ä°ÅŸlem AÃ§</title>

<style>
:root{
  --green:#16a34a;
  --red:#dc2626;
  --gray:#9ca3af;
  --blue:#2563eb;
  --bg:#f3f6f7;
}

*{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto}
body{margin:0;background:var(--bg)}
.container{max-width:480px;margin:auto;padding:16px;min-height:100vh;display:flex;flex-direction:column;gap:12px}

.card{
  background:#fff;
  border-radius:16px;
  padding:16px;
  box-shadow:0 8px 20px rgba(0,0,0,.05);
}

h1{margin:0;font-size:22px}
.sub{font-size:14px;color:#6b7280}

.section{font-weight:600;margin-bottom:6px}

input,select{
  width:100%;
  padding:14px;
  border:none;
  border-radius:12px;
  background:#eef2f3;
  font-size:15px;
}

button{
  width:100%;
  padding:14px;
  border:none;
  border-radius:14px;
  font-size:15px;
  font-weight:600;
  cursor:pointer;
}

.row{display:flex;gap:8px}

.trend button{color:#fff;opacity:.4}
.trend .active{opacity:1}
.long{background:var(--green)}
.short{background:var(--red)}
.range{background:var(--gray)}

.auto{background:#f1f5f9;border-radius:12px;padding:8px;font-size:13px}
.warn{color:var(--red);font-size:13px}

.alt{background:#f8fafc;border-radius:12px;padding:10px;margin-top:6px}
.hidden{display:none}

.ema-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:6px}
.ema{padding:8px;background:#e5e7eb;border-radius:8px;text-align:center;font-size:13px}
.ema.active{background:var(--blue);color:#fff}

.primary{background:var(--blue);color:#fff;margin-top:auto}

.topbar{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:8px;
}

.auto-btn{
  padding:8px 12px;
  border-radius:10px;
  font-size:13px;
}

.auto-on{background:var(--green);color:#fff}
.auto-off{background:#e5e7eb}
</style>
</head>

<body>
<div class="container">

<!-- TOP -->
<div class="card topbar">
  <button onclick="location.href='index.html'">â¬… Ana Panel</button>
  <button id="autoBtn" class="auto-btn auto-off" onclick="toggleAuto()">âš¡ Otomatik KAPALI</button>
</div>

<!-- HEADER -->
<div class="card">
  <h1>ðŸ“ˆ Ä°ÅŸlem AÃ§</h1>
  <div class="sub">Yeni iÅŸlem giriÅŸi</div>
</div>

<!-- VARLIK -->
<div class="card">
  <div class="section">VarlÄ±k</div>
  <input id="symbolInput" placeholder="Hisse / Coin yaz">
  <div id="symbolList" class="auto hidden"></div>
</div>

<!-- TREND -->
<div class="card">
  <div class="section">Trend YÃ¶nÃ¼</div>
  <div class="row trend">
    <button class="long" onclick="setTrend('LONG',this)">YÃ¼kselen</button>
    <button class="short" onclick="setTrend('SHORT',this)">DÃ¼ÅŸen</button>
    <button class="range" onclick="setTrend('RANGE',this)">Yatay</button>
  </div>
</div>

<!-- TIMEFRAME -->
<div class="card">
  <div class="section">Zaman Dilimi</div>
  <select>
    <option>1m</option><option>5m</option><option selected>15m</option>
    <option>30m</option><option>1h</option><option>4h</option><option>1d</option>
  </select>
</div>

<!-- PRICE -->
<div class="card">
  <div class="section">AlÄ±ÅŸ FiyatÄ±</div>
  <input id="entry" type="number">
</div>

<!-- STOP -->
<div class="card">
  <div class="section">Stop</div>
  <label><input type="checkbox" id="manualStop"> Manuel</label>
  <input id="stop" disabled>
  <div id="risk" class="warn"></div>
</div>

<!-- TARGET -->
<div class="card">
  <div class="section">Hedef (Opsiyonel)</div>
  <input id="target" type="number">
  <div id="rr" class="auto"></div>
</div>

<!-- ANALYSIS -->
<div class="card">
  <div class="section">Teknik Analiz Veri GiriÅŸi</div>

  <label><input type="checkbox" onchange="toggle('smc')"> SMC</label>
  <div id="smc" class="alt hidden">BOS Â· CHoCH Â· OB Â· Likidite</div>

  <label><input type="checkbox" onchange="toggle('ema')"> EMA</label>
  <div id="ema" class="alt hidden"><div class="ema-grid" id="emaGrid"></div></div>

  <label><input type="checkbox"> RSI</label>
  <label><input type="checkbox"> MACD</label>
  <label><input type="checkbox"> Hacim</label>

  <label><input type="checkbox" onchange="toggle('other')"> DiÄŸer</label>
  <div id="other" class="alt hidden"><input placeholder="AÃ§Ä±klama (zorunlu)"></div>
</div>

<button class="primary" onclick="openTrade()">+ Ä°ÅžLEM AÃ‡</button>

</div>

<script>
/* ---------- DATA ---------- */
const symbols=["FROTO","ASELS","THYAO","ALKIM","BTCUSDT","ETHUSDT","ADAUSDT"];
let trend=null,auto=false;

/* ---------- AUTOCOMPLETE ---------- */
const sInput=document.getElementById("symbolInput");
const sList=document.getElementById("symbolList");
sInput.oninput=()=>{
  const v=sInput.value.toUpperCase();
  const m=symbols.filter(x=>x.startsWith(v));
  sList.innerHTML=m.map(x=>`<div onclick="selectSymbol('${x}')">${x}</div>`).join("");
  sList.classList.toggle("hidden",!m.length);
}
function selectSymbol(v){
  sInput.value=v;
  sList.classList.add("hidden");
  startPriceTracking(v);
}

/* ---------- TREND ---------- */
function setTrend(v,el){
  trend=v;
  document.querySelectorAll(".trend button").forEach(b=>b.classList.remove("active"));
  el.classList.add("active");
}

/* ---------- STOP ---------- */
const entry=document.getElementById("entry");
const stop=document.getElementById("stop");
const manual=document.getElementById("manualStop");
const risk=document.getElementById("risk");

entry.oninput=()=>{if(!manual.checked)stop.value=(entry.value*0.99).toFixed(2)}
manual.onchange=()=>stop.disabled=!manual.checked;
stop.oninput=()=>{
  const r=((entry.value-stop.value)/entry.value*100).toFixed(2);
  risk.textContent=`Risk: %${r}`;
}

/* ---------- RR ---------- */
document.getElementById("target").oninput=()=>{
  const r=((target.value-entry.value)/(entry.value-stop.value)).toFixed(2);
  document.getElementById("rr").textContent=`RR: 1 : ${r}`;
}

/* ---------- EMA ---------- */
const emaVals=[3,5,7,9,11,13,14,19,20,21,48,50,100,144,200];
const eg=document.getElementById("emaGrid");
emaVals.forEach(v=>{
  const d=document.createElement("div");
  d.className="ema";
  d.textContent=v;
  d.onclick=()=>{document.querySelectorAll(".ema").forEach(x=>x.classList.remove("active"));d.classList.add("active")}
  eg.appendChild(d);
})

/* ---------- TOGGLE ---------- */
function toggle(id){document.getElementById(id).classList.toggle("hidden")}

/* ---------- AUTO ---------- */
function toggleAuto(){
  auto=!auto;
  const b=document.getElementById("autoBtn");
  b.className="auto-btn "+(auto?"auto-on":"auto-off");
  b.textContent=auto?"âš¡ Otomatik AÃ‡IK":"âš¡ Otomatik KAPALI";
}

/* ---------- PRICE (BINANCE) ---------- */
let timer=null;
async function fetchPrice(sym){
  if(!sym.endsWith("USDT"))return;
  const r=await fetch(`https://api.binance.com/api/v3/ticker/price?symbol=${sym}`);
  const d=await r.json();
  if(!entry.value)entry.value=parseFloat(d.price).toFixed(2);
}
function startPriceTracking(sym){
  if(timer)clearInterval(timer);
  fetchPrice(sym);
  timer=setInterval(()=>fetchPrice(sym),15000);
}

/* ---------- SUBMIT ---------- */
function openTrade(){
  if(!trend||!sInput.value||!entry.value){alert("Zorunlu alanlar eksik");return;}
  alert("Ä°ÅŸlem aÃ§Ä±ldÄ± (demo)");
}
</script>
</body>
</html>